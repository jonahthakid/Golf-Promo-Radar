<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Golf Promo Radar</title>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    
    :root {
      --bg-primary: #0a0f0d;
      --bg-secondary: #1a2f1c;
      --bg-card: rgba(30, 50, 35, 0.8);
      --green-500: #4caf50;
      --green-400: #66bb6a;
      --green-300: #81c784;
      --green-200: #a5d6a7;
      --green-100: #c8e6c9;
      --green-dim: #689f6a;
      --text-primary: #e8f5e9;
      --border: rgba(76, 175, 80, 0.2);
    }
    
    body {
      font-family: 'JetBrains Mono', monospace;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 50%, var(--bg-primary) 100%);
      color: var(--text-primary);
      min-height: 100vh;
      line-height: 1.5;
    }
    
    .bg-pattern {
      position: fixed;
      inset: 0;
      background-image: 
        radial-gradient(circle at 20% 80%, rgba(76, 175, 80, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(139, 195, 74, 0.06) 0%, transparent 50%),
        repeating-linear-gradient(0deg, transparent, transparent 100px, rgba(76, 175, 80, 0.02) 100px, rgba(76, 175, 80, 0.02) 101px),
        repeating-linear-gradient(90deg, transparent, transparent 100px, rgba(76, 175, 80, 0.02) 100px, rgba(76, 175, 80, 0.02) 101px);
      pointer-events: none;
      z-index: 0;
    }
    
    .container { max-width: 1400px; margin: 0 auto; position: relative; z-index: 1; }
    
    /* Header */
    header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(10, 15, 13, 0.9);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border);
      padding: 16px 24px;
    }
    
    .header-top { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 16px; }
    
    .logo { display: flex; align-items: center; gap: 16px; }
    .logo-icon {
      width: 48px; height: 48px;
      background: linear-gradient(135deg, var(--green-500), var(--green-300));
      border-radius: 14px;
      display: flex; align-items: center; justify-content: center;
      font-size: 26px;
      box-shadow: 0 4px 20px rgba(76, 175, 80, 0.4);
    }
    .logo h1 {
      font-size: 24px; font-weight: 700;
      background: linear-gradient(135deg, var(--text-primary), var(--green-200));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .logo p { font-size: 11px; color: var(--green-300); letter-spacing: 2px; margin-top: 4px; }
    
    .header-controls { display: flex; align-items: center; gap: 16px; }
    
    .status-pill {
      display: flex; align-items: center; gap: 10px;
      padding: 10px 16px;
      background: rgba(76, 175, 80, 0.1);
      border-radius: 10px;
      border: 1px solid var(--border);
    }
    .status-dot {
      width: 10px; height: 10px; border-radius: 50%;
      background: var(--green-500);
      box-shadow: 0 0 12px var(--green-500);
      animation: pulse 2s infinite;
    }
    .status-dot.scanning { background: #ffc107; box-shadow: 0 0 12px #ffc107; animation: pulse 0.5s infinite; }
    .status-text { font-size: 12px; color: var(--green-200); }
    
    .btn-refresh {
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--green-500), #2e7d32);
      border: none; border-radius: 10px;
      color: #fff; font-size: 13px; font-weight: 600;
      cursor: pointer;
      display: flex; align-items: center; gap: 8px;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
      font-family: inherit;
    }
    .btn-refresh:hover { transform: translateY(-2px); box-shadow: 0 6px 25px rgba(76, 175, 80, 0.4); }
    .btn-refresh:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .btn-refresh .icon { display: inline-block; transition: transform 0.3s; }
    .btn-refresh.spinning .icon { animation: spin 1s linear infinite; }
    
    /* Search & Filters */
    .filters { display: flex; gap: 16px; align-items: center; flex-wrap: wrap; }
    
    .search-wrap {
      flex: 1 1 320px;
      position: relative;
    }
    .search-wrap input {
      width: 100%; padding: 14px 16px 14px 48px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 12px;
      color: var(--text-primary);
      font-size: 14px; font-family: inherit;
      outline: none;
      transition: all 0.2s;
    }
    .search-wrap input:focus { border-color: var(--green-500); background: rgba(255,255,255,0.08); }
    .search-wrap input::placeholder { color: var(--green-dim); }
    .search-wrap .icon { position: absolute; left: 16px; top: 50%; transform: translateY(-50%); color: var(--green-300); font-size: 18px; }
    
    .filter-pills { display: flex; gap: 8px; flex-wrap: wrap; }
    .filter-pill {
      padding: 10px 16px;
      background: rgba(255,255,255,0.05);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--green-200);
      font-size: 12px; font-weight: 500;
      cursor: pointer;
      display: flex; align-items: center; gap: 8px;
      transition: all 0.2s;
      font-family: inherit;
    }
    .filter-pill:hover { background: rgba(76, 175, 80, 0.1); border-color: rgba(76, 175, 80, 0.3); }
    .filter-pill.active {
      background: linear-gradient(135deg, var(--green-500), #2e7d32);
      border: none; color: #fff;
    }
    
    /* Stats Bar */
    .stats-bar {
      background: rgba(0,0,0,0.3);
      border-bottom: 1px solid rgba(76, 175, 80, 0.1);
      padding: 14px 24px;
    }
    .stats-inner { display: flex; gap: 40px; align-items: center; flex-wrap: wrap; }
    .stat { display: flex; align-items: center; gap: 10px; }
    .stat-icon { font-size: 22px; }
    .stat-value { font-size: 28px; font-weight: 700; color: var(--green-300); }
    .stat-label { font-size: 12px; color: var(--green-dim); }
    .stat-updated { margin-left: auto; font-size: 11px; color: var(--green-dim); }
    .stat-updated span { color: var(--green-200); }
    
    /* Tabs */
    .tabs { padding: 20px 24px 0; }
    .tabs-inner { display: flex; gap: 4px; border-bottom: 1px solid var(--border); }
    .tab-btn {
      padding: 14px 24px;
      background: transparent;
      border: none;
      border-bottom: 2px solid transparent;
      color: var(--green-dim);
      font-size: 13px; font-weight: 600;
      cursor: pointer;
      display: flex; align-items: center; gap: 10px;
      transition: all 0.2s;
      font-family: inherit;
      margin-bottom: -1px;
    }
    .tab-btn:hover { color: var(--green-300); background: rgba(76, 175, 80, 0.05); }
    .tab-btn.active { color: var(--green-300); background: rgba(76, 175, 80, 0.15); border-bottom-color: var(--green-500); }
    
    /* Content */
    main { padding: 24px; }
    
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 16px; }
    
    /* Promo Card */
    .promo-card {
      background: linear-gradient(135deg, var(--bg-card), rgba(20, 35, 25, 0.9));
      border-radius: 18px;
      border: 1px solid var(--border);
      padding: 22px;
      position: relative;
      overflow: hidden;
      transition: all 0.3s;
    }
    .promo-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 16px 48px rgba(76, 175, 80, 0.15);
      border-color: rgba(76, 175, 80, 0.4);
    }
    
    .discount-badge {
      position: absolute; top: 18px; right: 18px;
      padding: 8px 14px;
      background: linear-gradient(135deg, var(--green-500), #2e7d32);
      border-radius: 24px;
      font-size: 12px; font-weight: 700;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    .discount-badge.hot { background: linear-gradient(135deg, #ff5722, #e64a19); }
    
    .card-header { margin-bottom: 14px; }
    .card-header h3 { font-size: 19px; font-weight: 700; color: var(--text-primary); }
    .category-tag {
      display: inline-block; margin-top: 8px;
      padding: 5px 12px;
      background: rgba(76, 175, 80, 0.15);
      border-radius: 8px;
      font-size: 10px; color: var(--green-300);
      text-transform: uppercase; letter-spacing: 1.5px;
    }
    
    .card-promo { margin: 14px 0; font-size: 16px; color: var(--green-200); font-weight: 500; }
    
    .code-btn {
      display: flex; align-items: center; gap: 10px;
      padding: 12px 16px;
      background: rgba(76, 175, 80, 0.1);
      border: 1px dashed rgba(76, 175, 80, 0.4);
      border-radius: 10px;
      color: var(--green-300);
      font-size: 14px; font-weight: 600;
      cursor: pointer;
      font-family: monospace;
      transition: all 0.2s;
      width: fit-content;
    }
    .code-btn:hover { background: rgba(76, 175, 80, 0.2); border-color: rgba(76, 175, 80, 0.6); }
    .code-btn.copied { background: linear-gradient(135deg, #2e7d32, #1b5e20); border-style: solid; }
    .code-btn small { font-size: 10px; opacity: 0.7; font-family: 'JetBrains Mono', monospace; }
    
    .tags { display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap; }
    .tag {
      padding: 5px 12px;
      background: rgba(255,255,255,0.05);
      border-radius: 8px;
      font-size: 10px; color: var(--green-dim);
    }
    
    .shop-btn {
      display: inline-flex; align-items: center; gap: 8px;
      margin-top: 18px;
      padding: 12px 20px;
      background: linear-gradient(135deg, var(--green-500), #2e7d32);
      border-radius: 10px;
      color: #fff;
      font-size: 12px; font-weight: 600;
      text-decoration: none;
      transition: all 0.2s;
      box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
    }
    .shop-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 25px rgba(76, 175, 80, 0.4); }
    
    /* Code Card */
    .code-card {
      background: linear-gradient(135deg, var(--bg-card), rgba(20, 35, 25, 0.9));
      border-radius: 14px;
      border: 1px solid var(--border);
      padding: 18px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex; align-items: center; gap: 18px;
    }
    .code-card:hover { border-color: rgba(76, 175, 80, 0.4); background: rgba(40, 60, 45, 0.8); }
    .code-card.copied { border-color: var(--green-500); }
    .code-card-icon {
      width: 54px; height: 54px;
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      font-size: 26px;
    }
    .code-card-info { flex: 1; }
    .code-card-brand { font-size: 11px; color: var(--green-dim); margin-bottom: 4px; }
    .code-card-code { font-size: 18px; font-weight: 700; color: var(--green-300); letter-spacing: 2px; }
    .code-card-discount { font-size: 12px; color: var(--green-200); margin-top: 4px; }
    .code-card-action { font-size: 10px; color: var(--green-dim); white-space: nowrap; }
    
    /* Email Card */
    .email-card {
      background: linear-gradient(135deg, var(--bg-card), rgba(20, 35, 25, 0.9));
      border-radius: 14px;
      border: 1px solid var(--border);
      padding: 22px;
      display: flex; align-items: center; gap: 18px;
    }
    .email-card-icon {
      width: 56px; height: 56px;
      background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
      border-radius: 14px;
      display: flex; align-items: center; justify-content: center;
      font-size: 28px;
    }
    .email-card-info { flex: 1; }
    .email-card-brand { font-size: 16px; font-weight: 700; color: var(--text-primary); }
    .email-card-offer { font-size: 14px; color: var(--green-300); margin-top: 4px; }
    .email-method {
      padding: 8px 14px;
      background: rgba(76, 175, 80, 0.15);
      border-radius: 8px;
      font-size: 10px; color: var(--green-300);
      text-transform: uppercase; letter-spacing: 1px;
    }
    
    /* Notification */
    .notification {
      position: fixed; top: 24px; right: 24px;
      background: linear-gradient(135deg, #2e7d32, #1b5e20);
      padding: 14px 22px;
      border-radius: 12px;
      display: flex; align-items: center; gap: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.4);
      transform: translateX(150%);
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
      z-index: 1000;
    }
    .notification.show { transform: translateX(0); }
    .notification-icon { color: #69f0ae; font-size: 20px; }
    .notification-text { font-size: 13px; }
    
    /* Footer */
    footer {
      padding: 28px;
      text-align: center;
      border-top: 1px solid rgba(76, 175, 80, 0.1);
      margin-top: 48px;
    }
    footer p { font-size: 11px; color: var(--green-dim); }
    
    /* Animations */
    @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 10px; }
    ::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
    ::-webkit-scrollbar-thumb { background: rgba(76, 175, 80, 0.3); border-radius: 5px; }
    ::-webkit-scrollbar-thumb:hover { background: rgba(76, 175, 80, 0.5); }
    
    /* Responsive */
    @media (max-width: 768px) {
      .grid { grid-template-columns: 1fr; }
      .header-top { flex-direction: column; align-items: flex-start; }
      .header-controls { width: 100%; justify-content: space-between; }
      .stats-inner { gap: 20px; }
      .stat-updated { width: 100%; margin-left: 0; margin-top: 12px; }
    }
  </style>
</head>
<body>
  <div class="bg-pattern"></div>
  
  <div class="notification" id="notification">
    <span class="notification-icon">‚úì</span>
    <span class="notification-text">Promos refreshed successfully</span>
  </div>
  
  <header>
    <div class="container">
      <div class="header-top">
        <div class="logo">
          <div class="logo-icon">‚õ≥</div>
          <div>
            <h1>GOLF PROMO RADAR</h1>
            <p>LIVE DISCOUNT INTELLIGENCE</p>
          </div>
        </div>
        
        <div class="header-controls">
          <div class="status-pill">
            <div class="status-dot" id="statusDot"></div>
            <span class="status-text" id="statusText">Next scan: 5:00</span>
          </div>
          <button class="btn-refresh" id="refreshBtn" onclick="refresh()">
            <span class="icon">‚Üª</span>
            Refresh Now
          </button>
        </div>
      </div>
      
      <div class="filters">
        <div class="search-wrap">
          <span class="icon">‚åï</span>
          <input type="text" id="searchInput" placeholder="Search brands, promos, tags..." oninput="filterPromos()">
        </div>
        
        <div class="filter-pills" id="filterPills">
          <button class="filter-pill active" data-category="all" onclick="setCategory('all')">‚óâ All</button>
          <button class="filter-pill" data-category="apparel" onclick="setCategory('apparel')">üëï Apparel</button>
          <button class="filter-pill" data-category="footwear" onclick="setCategory('footwear')">üëü Footwear</button>
          <button class="filter-pill" data-category="bags" onclick="setCategory('bags')">üéí Bags</button>
          <button class="filter-pill" data-category="oem" onclick="setCategory('oem')">üèåÔ∏è OEMs</button>
          <button class="filter-pill" data-category="retailer" onclick="setCategory('retailer')">üè™ Retailers</button>
          <button class="filter-pill" data-category="womens" onclick="setCategory('womens')">üëó Womens</button>
        </div>
      </div>
    </div>
  </header>
  
  <div class="stats-bar">
    <div class="container stats-inner">
      <div class="stat">
        <span class="stat-icon">üè∑Ô∏è</span>
        <span class="stat-value" id="promoCount">45</span>
        <span class="stat-label">Active Promos</span>
      </div>
      <div class="stat">
        <span class="stat-icon">üìß</span>
        <span class="stat-value" id="emailCount">10</span>
        <span class="stat-label">Welcome Offers</span>
      </div>
      <div class="stat">
        <span class="stat-icon">üéüÔ∏è</span>
        <span class="stat-value" id="codeCount">10</span>
        <span class="stat-label">Promo Codes</span>
      </div>
      <div class="stat-updated">
        Last updated: <span id="lastUpdated"></span>
      </div>
    </div>
  </div>
  
  <div class="tabs">
    <div class="container tabs-inner">
      <button class="tab-btn active" data-tab="promos" onclick="setTab('promos')">üè∑Ô∏è Sitewide Promos</button>
      <button class="tab-btn" data-tab="codes" onclick="setTab('codes')">üéüÔ∏è Promo Codes</button>
      <button class="tab-btn" data-tab="email" onclick="setTab('email')">üìß Email Offers</button>
    </div>
  </div>
  
  <main class="container">
    <div class="grid" id="content"></div>
  </main>
  
  <footer>
    <div class="container">
      <p>Golf Promo Radar ‚Ä¢ Auto-refreshes every 5 minutes ‚Ä¢ Data sourced from brand homepages</p>
    </div>
  </footer>

  <script>
    // Data
    const DATA = {
      promos: [
        // Major Athletic
        { brand: "Nike Golf", url: "https://www.nike.com/w/golf-3glsm", promo: "Up to 40% off select styles", code: null, category: "apparel", tags: ["major", "footwear"] },
        { brand: "Adidas Golf", url: "https://www.adidas.com/us/golf", promo: "Up to 50% off", code: null, category: "apparel", tags: ["major", "footwear"] },
        { brand: "Under Armour", url: "https://underarmour.com", promo: "Up to 40% off sitewide", code: "CHEATCODE", category: "apparel", tags: ["major", "performance"] },
        { brand: "PUMA Golf", url: "https://us.puma.com/us/en/golf", promo: "Up to 50% off + extra 30%", code: null, category: "apparel", tags: ["major", "rickie"] },
        
        // Premium
        { brand: "Peter Millar", url: "https://www.petermillar.com/golf/", promo: "Up to 30% off sale", code: null, category: "apparel", tags: ["premium", "country-club"] },
        { brand: "G/FORE", url: "https://www.gfore.com", promo: "Sale section active", code: null, category: "apparel", tags: ["premium", "lifestyle"] },
        { brand: "Greyson Clothiers", url: "https://www.greysonclothiers.com", promo: "Holiday sale active", code: null, category: "apparel", tags: ["premium", "modern"] },
        { brand: "Ralph Lauren RLX", url: "https://www.ralphlauren.com/brands-rlx", promo: "Up to 30% off", code: null, category: "apparel", tags: ["premium", "luxury"] },
        { brand: "J.Lindeberg", url: "https://www.jlindeberg.com/us/golf", promo: "Up to 50% off sale", code: null, category: "apparel", tags: ["premium", "european"] },
        { brand: "Holderness & Bourne", url: "https://www.holderness-bourne.com", promo: "20% off sitewide", code: null, category: "apparel", tags: ["premium", "polos"] },
        { brand: "Zero Restriction", url: "https://www.zerorestriction.com", promo: "Sale section active", code: null, category: "apparel", tags: ["premium", "outerwear"] },
        
        // Lifestyle
        { brand: "Malbon Golf", url: "https://malbongolf.com", promo: "Up to 60% off archive", code: "ARCHIVESALE", category: "apparel", tags: ["lifestyle", "streetwear"] },
        { brand: "TravisMathew", url: "https://www.travismathew.com", promo: "Holiday gift picks", code: null, category: "apparel", tags: ["lifestyle", "socal"] },
        { brand: "Eastside Golf", url: "https://www.eastsidegolf.com", promo: "New drops available", code: null, category: "apparel", tags: ["lifestyle", "jordan"] },
        { brand: "Bad Birdie", url: "https://badbirdie.com", promo: "Up to 50% off", code: null, category: "apparel", tags: ["lifestyle", "prints"] },
        { brand: "Sunday Red", url: "https://www.sundayred.com", promo: "Up to 50% off select", code: null, category: "apparel", tags: ["lifestyle", "tiger"] },
        { brand: "Bogey Boys", url: "https://bogeyboys.com", promo: "Holiday collection live", code: null, category: "apparel", tags: ["lifestyle", "macklemore"] },
        
        // Womens
        { brand: "Lohla Sport", url: "https://lohlasport.com", promo: "Up to 40% off", code: null, category: "apparel", tags: ["womens", "performance"] },
        { brand: "Foray Golf", url: "https://foraygolf.com", promo: "Sale section active", code: null, category: "apparel", tags: ["womens", "modern"] },
        { brand: "Tory Sport", url: "https://www.toryburch.com/en-us/sport/", promo: "Up to 30% off", code: null, category: "apparel", tags: ["womens", "luxury"] },
        { brand: "Daily Sports", url: "https://dailysports.com", promo: "Winter sale active", code: null, category: "apparel", tags: ["womens", "european"] },
        
        // Mid-Tier
        { brand: "Rhoback", url: "https://rhoback.com", promo: "20% off sitewide", code: null, category: "apparel", tags: ["mid-tier", "polos"] },
        { brand: "Swannies", url: "https://swannies.co", promo: "30% off sitewide", code: null, category: "apparel", tags: ["mid-tier", "hoodies"] },
        { brand: "Radmor", url: "https://radmor.com", promo: "30% off sitewide", code: null, category: "apparel", tags: ["mid-tier", "pants"] },
        { brand: "Devereux Golf", url: "https://devereuxgolf.com", promo: "30% off sitewide", code: null, category: "apparel", tags: ["mid-tier", "streetwear"] },
        { brand: "Avalon Golf", url: "https://avalongolf.co", promo: "Up to 60% off", code: null, category: "apparel", tags: ["mid-tier", "joggers"] },
        { brand: "Walter Hagen", url: "https://www.dickssportinggoods.com/f/walter-hagen-golf", promo: "Deals at Dick's", code: null, category: "apparel", tags: ["value"] },
        { brand: "PGA TOUR Apparel", url: "https://www.golfapparelshop.com", promo: "Up to 75% off", code: null, category: "apparel", tags: ["value"] },
        { brand: "Uniqlo", url: "https://www.uniqlo.com", promo: "Limited time offers", code: null, category: "apparel", tags: ["value", "basics"] },
        
        // Footwear
        { brand: "FootJoy", url: "https://www.footjoy.com", promo: "Closeout deals", code: null, category: "footwear", tags: ["tour", "gloves"] },
        { brand: "True Linkswear", url: "https://truelinkswear.com", promo: "20% sitewide + 70% select", code: null, category: "footwear", tags: ["comfort", "walking"] },
        
        // Bags
        { brand: "Vessel", url: "https://vesselgolf.com", promo: "Up to 40% off", code: null, category: "bags", tags: ["premium"] },
        { brand: "Stitch Golf", url: "https://stitchgolf.com", promo: "30% off sitewide", code: "GIFTING", category: "bags", tags: ["travel", "headcovers"] },
        
        // OEMs
        { brand: "TaylorMade", url: "https://taylormadegolf.com", promo: "Up to 50% off apparel", code: null, category: "oem", tags: ["clubs", "apparel"] },
        { brand: "Callaway Apparel", url: "https://www.callawayapparel.com", promo: "Sale section active", code: null, category: "oem", tags: ["apparel"] },
        { brand: "Titleist", url: "https://www.titleist.com", promo: "Gear deals available", code: null, category: "oem", tags: ["balls", "gear"] },
        { brand: "Cobra Golf", url: "https://www.cobragolf.com", promo: "Holiday deals", code: null, category: "oem", tags: ["clubs", "puma"] },
        
        // Retailers
        { brand: "PGA Tour Superstore", url: "https://pgatoursuperstore.com", promo: "Extra 25% off clearance", code: null, category: "retailer", tags: ["multi-brand"] },
        { brand: "Golf Galaxy", url: "https://golfgalaxy.com", promo: "Weekly deals active", code: null, category: "retailer", tags: ["multi-brand"] },
        { brand: "Carl's Golfland", url: "https://carlsgolfland.com", promo: "Free shipping + deals", code: null, category: "retailer", tags: ["multi-brand"] },
        { brand: "Rock Bottom Golf", url: "https://www.rockbottomgolf.com", promo: "Up to 80% off", code: null, category: "retailer", tags: ["discount"] },
        { brand: "Global Golf", url: "https://www.globalgolf.com", promo: "Trade-in bonus active", code: null, category: "retailer", tags: ["used"] },
        { brand: "2nd Swing", url: "https://www.2ndswing.com", promo: "Pre-owned deals", code: null, category: "retailer", tags: ["used"] },
        { brand: "Trendy Golf", url: "https://trendygolfusa.com", promo: "Up to 50% off sale", code: null, category: "retailer", tags: ["premium"] },
        { brand: "Golf Apparel Shop", url: "https://www.golfapparelshop.com", promo: "Extra 25% off clearance", code: null, category: "retailer", tags: ["value"] },
      ],
      emailOffers: [
        { brand: "Nike", offer: "10% off first order", method: "Email" },
        { brand: "Malbon Golf", offer: "10% off first order", method: "Newsletter" },
        { brand: "Golf Apparel Shop", offer: "15% off first purchase", method: "Email" },
        { brand: "Golf Apparel Shop", offer: "20% off first order", method: "SMS" },
        { brand: "Golf Galaxy", offer: "15% off", method: "Text Alerts" },
        { brand: "Avalon Golf", offer: "10% off first purchase", method: "Email" },
        { brand: "Rhoback", offer: "15% off first order", method: "Email" },
        { brand: "TravisMathew", offer: "TM Rewards signup", method: "Loyalty" },
        { brand: "FootJoy", offer: "MyFJ rewards", method: "Loyalty" },
        { brand: "Peter Millar", offer: "Early access to sales", method: "Email" },
      ],
      codes: [
        { brand: "Malbon Golf", code: "ARCHIVESALE", discount: "60% off archive" },
        { brand: "Malbon Golf", code: "MALBONFAMILY7010", discount: "30% off" },
        { brand: "Malbon Golf", code: "FIRST10", discount: "10% first order" },
        { brand: "Stitch Golf", code: "GIFTING", discount: "30% sitewide" },
        { brand: "Stitch Golf", code: "STITCHMAS", discount: "40% off bags" },
        { brand: "Stitch Golf", code: "FREQUENTFLYER", discount: "40% travel" },
        { brand: "B. Draddy", code: "CYBER35", discount: "35% sitewide" },
        { brand: "Under Armour", code: "CHEATCODE", discount: "40% sitewide" },
        { brand: "Zero Restriction", code: "HOLIDAY25", discount: "25% off" },
        { brand: "Holderness & Bourne", code: "HB20", discount: "20% off" },
      ]
    };
    
    let currentTab = 'promos';
    let currentCategory = 'all';
    let copiedCode = null;
    let countdown = 300;
    let isRefreshing = false;
    
    // Check if server is running and fetch live data
    async function fetchFromAPI() {
      try {
        const response = await fetch('/api/promos');
        if (response.ok) {
          const apiData = await response.json();
          if (apiData.promos) DATA.promos = apiData.promos;
          if (apiData.codes) DATA.codes = apiData.codes;
          if (apiData.emailOffers) DATA.emailOffers = apiData.emailOffers;
          document.getElementById('promoCount').textContent = DATA.promos.length;
          document.getElementById('emailCount').textContent = DATA.emailOffers.length;
          document.getElementById('codeCount').textContent = DATA.codes.length;
          if (apiData.lastUpdated) {
            document.getElementById('lastUpdated').textContent = new Date(apiData.lastUpdated).toLocaleString();
          }
          console.log('‚úì Loaded live data from API');
          return true;
        }
      } catch (e) {
        console.log('‚Ñπ Running in standalone mode (no API)');
      }
      return false;
    }
    
    // Initialize
    document.addEventListener('DOMContentLoaded', async () => {
      await fetchFromAPI();
      updateLastUpdated();
      render();
      startCountdown();
    });
    
    function updateLastUpdated() {
      document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
    }
    
    function startCountdown() {
      setInterval(() => {
        if (isRefreshing) return;
        countdown--;
        if (countdown <= 0) {
          refresh();
          countdown = 300;
        }
        const m = Math.floor(countdown / 60);
        const s = countdown % 60;
        document.getElementById('statusText').textContent = `Next scan: ${m}:${s.toString().padStart(2, '0')}`;
      }, 1000);
    }
    
    async function refresh() {
      if (isRefreshing) return;
      isRefreshing = true;
      
      const btn = document.getElementById('refreshBtn');
      const dot = document.getElementById('statusDot');
      
      btn.disabled = true;
      btn.classList.add('spinning');
      btn.querySelector('.icon').textContent = '‚Üª';
      dot.classList.add('scanning');
      document.getElementById('statusText').textContent = 'Scanning...';
      
      // Try to trigger API refresh
      let apiRefresh = false;
      try {
        const response = await fetch('/api/refresh', { method: 'POST' });
        if (response.ok) {
          apiRefresh = true;
          // Wait a bit for scraper to start, then poll for new data
          await new Promise(r => setTimeout(r, 3000));
          await fetchFromAPI();
        }
      } catch (e) {
        // Running standalone
      }
      
      setTimeout(async () => {
        if (apiRefresh) {
          await fetchFromAPI();
        }
        isRefreshing = false;
        btn.disabled = false;
        btn.classList.remove('spinning');
        dot.classList.remove('scanning');
        countdown = 300;
        updateLastUpdated();
        render();
        showNotification();
      }, apiRefresh ? 500 : 1500);
    }
    
    function showNotification() {
      const notif = document.getElementById('notification');
      notif.classList.add('show');
      setTimeout(() => notif.classList.remove('show'), 3000);
    }
    
    function setTab(tab) {
      currentTab = tab;
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tab === tab);
      });
      render();
    }
    
    function setCategory(cat) {
      currentCategory = cat;
      document.querySelectorAll('.filter-pill').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.category === cat);
      });
      render();
    }
    
    function filterPromos() {
      render();
    }
    
    function copyCode(code) {
      navigator.clipboard.writeText(code);
      copiedCode = code;
      render();
      setTimeout(() => {
        copiedCode = null;
        render();
      }, 2000);
    }
    
    function extractDiscount(promo) {
      const match = promo.match(/(\d+)%/);
      return match ? parseInt(match[1]) : 0;
    }
    
    function render() {
      const content = document.getElementById('content');
      const search = document.getElementById('searchInput').value.toLowerCase();
      
      if (currentTab === 'promos') {
        const filtered = DATA.promos.filter(p => {
          const matchesCat = currentCategory === 'all' || 
          p.category === currentCategory || 
          (currentCategory === 'womens' && p.tags.includes('womens'));
          const matchesSearch = !search || 
            p.brand.toLowerCase().includes(search) ||
            p.promo.toLowerCase().includes(search) ||
            p.tags.some(t => t.toLowerCase().includes(search));
          return matchesCat && matchesSearch;
        });
        
        content.innerHTML = filtered.map(p => {
          const discount = extractDiscount(p.promo);
          const isHot = discount >= 50;
          const showBadge = discount >= 30;
          
          return `
            <div class="promo-card">
              ${showBadge ? `<div class="discount-badge ${isHot ? 'hot' : ''}">${isHot ? 'üî•' : '‚ú®'} ${discount}% OFF</div>` : ''}
              <div class="card-header">
                <h3>${p.brand}</h3>
                <span class="category-tag">${p.category}</span>
              </div>
              <p class="card-promo">${p.promo}</p>
              ${p.code ? `
                <button class="code-btn ${copiedCode === p.code ? 'copied' : ''}" onclick="copyCode('${p.code}')">
                  <span>${copiedCode === p.code ? '‚úì' : 'üìã'}</span>
                  ${p.code}
                  <small>${copiedCode === p.code ? 'Copied!' : 'Click to copy'}</small>
                </button>
              ` : ''}
              <div class="tags">
                ${p.tags.map(t => `<span class="tag">#${t}</span>`).join('')}
              </div>
              <a href="${p.url}" target="_blank" class="shop-btn">Shop Now ‚Üí</a>
            </div>
          `;
        }).join('');
        
      } else if (currentTab === 'codes') {
        content.innerHTML = DATA.codes.map(c => `
          <div class="code-card ${copiedCode === c.code ? 'copied' : ''}" onclick="copyCode('${c.code}')">
            <div class="code-card-icon">${copiedCode === c.code ? '‚úì' : 'üéüÔ∏è'}</div>
            <div class="code-card-info">
              <div class="code-card-brand">${c.brand}</div>
              <div class="code-card-code">${c.code}</div>
              <div class="code-card-discount">${c.discount}</div>
            </div>
            <div class="code-card-action">${copiedCode === c.code ? 'Copied!' : 'Click to copy'}</div>
          </div>
        `).join('');
        
      } else if (currentTab === 'email') {
        content.innerHTML = DATA.emailOffers.map(e => `
          <div class="email-card">
            <div class="email-card-icon">üìß</div>
            <div class="email-card-info">
              <div class="email-card-brand">${e.brand}</div>
              <div class="email-card-offer">${e.offer}</div>
            </div>
            <span class="email-method">${e.method}</span>
          </div>
        `).join('');
      }
    }
  </script>
</body>
</html>
